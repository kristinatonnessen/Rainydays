
const mensProducts = [
  {
    name: "Rocket Jacket",
    brand: "RAINYDAYS",
    image: "mens_jackets/Rocket_jacket_05.jpg",
    mainImage: "mens_jackets/Rocket_jacket_05.jpg",
    thumbnails: [
      "mens_jackets/Rocket_jacket_05.jpg",
      "mens_jackets/Rocket_Jacket_06.jpg",
      "mens_jackets/Rocket_Jacket_07.jpg",
      "mens_jackets/Rocket_Jacket_08.jpg"
    ],
    link: "shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: `Made out of water and wind resistant fabric and zippers 
    to keep you dry in every situation. With a light and moveable fabric that 
    isolates in every condition, from the streets to high mountains, 
    this is the jacket you want for your adventures.`,
    details: `Water and wind resistant,breathable, and features a detachable hood, adjustable cuffs, and multiple pockets.`
  },
    {
    name: "Boarding Jacket",
    brand: "RAINYDAYS",
    image: "mens_jackets/Boarding_Jacket_02.jpg",
    mainImage: "mens_jackets/Boarding_Jacket_02.jpg",
    thumbnails: [
        "mens_jackets/Boarding_Jacket_02.jpg",
        "mens_jackets/Boarding_Jacket_03.jpg"
    ],
    link: "shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "Designed for snowboarding and winter sports. This jacket offers warmth and wind protection.",
    details: "Snow skirt, ski-pass pocket, fleece-lined collar, waterproof rating 15,000mm."
    },
  {
    name: "Drop Jacket",
    brand: "RAINYDAYS",
    image: "mens_jackets/Drop_Jacket_02.jpg",
    mainImage: "mens_jackets/Drop_Jacket_02.jpg",
    thumbnails: [
        "mens_jackets/Drop_Jacket_02.jpg",
        "mens_jackets/Drop_Jacket_03.jpg"
    ],
    link: "shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A versatile jacket for all occasions. Lightweight and packable.",
    details: "Water-resistant, breathable, and features multiple pockets."
  },
  {
    name: "Pump Jacket",
    brand: "RAINYDAYS",
    image: "mens_jackets/Pump_Jacket_02.jpg",
    mainImage: "mens_jackets/Pump_Jacket_02.jpg",
    thumbnails: [
        "mens_jackets/Pump_Jacket_02.jpg",
        "mens_jackets/Pump_Jacket_03.jpg"
    ],
    link: "shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "Perfect for layering, this jacket offers warmth without bulk.",
    details: "Insulated, water-repellent, and features a hood."
  },
  {
    name: "Sway Jacket",
    brand: "RAINYDAYS",
    image: "mens_jackets/Sway_Jacket_02.jpg",
    mainImage: "mens_jackets/Sway_Jacket_02.jpg",
    thumbnails: [
        "mens_jackets/Sway_Jacket_02.jpg",
        "mens_jackets/Sway_Jacket_03.jpg"
    ],
    link: "shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A stylish jacket for everyday wear.",
    details: "Lightweight, breathable, and features a modern design."
  }
];

const womensProducts = [
  {
    name: "Bomb Jacket",
    brand: "RAINYDAYS",
    image: "../womens_jackets/Bomb_Jacket_02.jpg",
    mainImage: "../womens_jackets/Bomb_Jacket_02.jpg",
    thumbnails: [
      "../womens_jackets/Bomb_Jacket_02.jpg",
      "../womens_jackets/Bomb_Jacket_03.jpg"
    ],
    link: "../shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A trendy jacket for the modern woman.",
    details: "Features a tailored fit and stylish design."
  },
  {
    name: "Braid Jacket",
    brand: "RAINYDAYS",
    image: "../womens_jackets/Braid_Jacket_02.jpg",
    mainImage: "../womens_jackets/Braid_Jacket_02.jpg",
    thumbnails: [
      "../womens_jackets/Braid_Jacket_02.jpg",
      "../womens_jackets/Braid_Jacket_03.jpg"
    ],
    link: "../shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A stylish jacket for the modern woman.",
    details: "Features a tailored fit and stylish design."
  },
  {
    name: "Frost Jacket",
    brand: "RAINYDAYS",
    image: "../womens_jackets/Frost_Jacket_02.jpg",
    mainImage: "../womens_jackets/Frost_Jacket_02.jpg",
    thumbnails: [
      "../womens_jackets/Frost_Jacket_02.jpg",
      "../womens_jackets/Frost_Jacket_03.jpg"
    ],
    link: "../shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A warm jacket for cold days.",
    details: "Insulated, water-resistant, and features a hood."
  },
  {
    name: "Haze Jacket",
    brand: "RAINYDAYS",
    image: "../womens_jackets/Haze_Jacket_02.jpg",
    mainImage: "../womens_jackets/Haze_Jacket_02.jpg",
    thumbnails: [
      "../womens_jackets/Haze_Jacket_02.jpg",
      "../womens_jackets/Haze_Jacket_03.jpg"
    ],
    link: "../shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A lightweight jacket for transitional weather.",
    details: "Packable, water-repellent, and features a hood."
  },
  {
    name: "Nordic Jacket",
    brand: "RAINYDAYS",
    image: "../womens_jackets/Nordic_Jacket_05.png",
    mainImage: "../womens_jackets/Nordic_Jacket_05.png",
    thumbnails: [
      "../womens_jackets/Nordic_Jacket_05.png",
      "../womens_jackets/Nordic_Jacket_06.png"
    ],
    link: "../shop/product.html",
    price: "1990 kr.",
    size: ["S", "M", "L", "XL"],
    quantity: [1, 2, 3],
    description: "A stylish jacket for everyday wear.",
    details: "Lightweight, breathable, and features a modern design."
  }
];


function renderProducts(products, containerId, isLink = false) {
  const container = document.getElementById(containerId);
  const spinner = document.getElementById("spinner");

  if (spinner) spinner.style.display = "block";

  setTimeout(() => {
    products.forEach(product => {
      const card = document.createElement("div");
      card.className = "product-card";

      const image = `<img src="${product.image}" alt="${product.name}">`;
      const name = `<h3 class="product-name">${product.name}</h3>`;
      const brand = `<p class="brand-name">RAINYDAYS</p>`;
      const price = `<p class="price">${product.price}</p>`;

      if (isLink && product.link) {
        const productUrl = `${product.link}?name=${encodeURIComponent(product.name)}`;
        card.innerHTML = `<a href="${productUrl}">${image}${name}${brand}${price}</a>`;
    } else {
        card.innerHTML = `${image}${name}${brand}${price}`;
    }

      container.appendChild(card);
    });

    if (spinner) spinner.style.display = "none";
  }, 500); 
}

document.addEventListener("DOMContentLoaded", () => {
  if (document.getElementById("mens-products")) {
    renderProducts(mensProducts, "mens-products", true);
  }

  if (document.getElementById("womens-products")) {
    renderProducts(womensProducts, "womens-products", true);
  }
});

function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}

function findProductByName(name) {
  return [...mensProducts, ...womensProducts].find(
    (product) => product.name === name
  );
}

function renderSingleProduct() {
  const productName = getQueryParam("name");
  const product = findProductByName(productName);

  if (!product) return;

  const productPage = document.getElementById("product-page");
  if (!productPage) return;

  productPage.innerHTML = `
    <div class="card-1">
      <div class="image-gallery">
        <div class="main-image">
          <img src="${product.mainImage}" alt="${product.name}" id="main-image">
        </div>
        <div class="thumbnail-images">
          ${product.thumbnails
            .map(img => `<img src="${img}" alt="${product.name}" class="thumbnail">`)
            .join("")}
        </div>
      </div>
    </div>

    <div class="card-2">
      <h1 class="h1">${product.name}</h1>
      <p class="p">${product.brand || "RAINYDAYS"}</p>
      <h2 class="h2">${product.price}</h2>
      <p class="p">${product.description}</p>

      <div class="size-selection">
        <h3 class="h2">Pick a Size</h3>
        <div class="size-options">
          ${product.size
            .map(
              size => `
            <input type="radio" id="size-${size}" name="size" value="${size}">
            <label for="size-${size}">${size}</label>
          `
            )
            .join("")}
        </div>
      </div>

      <div class="quantity-selection">
        <h3 class="h2">Quantity</h3>
        <div class="quantity-controls">
          <input type="number" class="quantity-input" value="1" min="1" max="${Math.max(...product.quantity)}">
        </div>
      </div>

      <button class="add-to-cart-btn" type="submit">Add to Cart</button>
    </div>

    <div class="card-3">
      <h2 class="h2">Product details</h2>
      <p class="p">${product.details}</p>
    </div>
  `;

  const thumbnails = document.querySelectorAll(".thumbnail");
  const mainImg = document.getElementById("main-image");

  thumbnails.forEach(thumbnail => {
    thumbnail.addEventListener("click", () => {
      mainImg.src = thumbnail.src;
    });
  });
}

document.addEventListener("DOMContentLoaded", () => {
  if (document.getElementById("product-page")) {
    renderSingleProduct();
  }
});
document.querySelector(".add-to-cart-btn").addEventListener("click", () => {
  addToCart(product); 
});

function addToCart(product) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  
  const existingItem = cart.find(item => item.name === product.name);
  if (existingItem) {
    existingItem.quantity += 1;
  } else {
    cart.push({ ...product, quantity: 1 });
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  alert(`${product.name} added to cart!`);
}


function renderCart() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const container = document.getElementById("cart-container");
  const totalSection = document.getElementById("total-section");
  container.innerHTML = "";

  let total = 0;

  cart.forEach((item, index) => {
    const price = parseInt(item.price.replace(/\D/g, ""));
    total += price * item.quantity;

    const productDiv = document.createElement("div");
    productDiv.className = "product";
    productDiv.innerHTML = `
      <img src="${item.image}" alt="${item.name}">
      <div class="product-details">
        <h2>${item.name}</h2>
        <p>${item.quantity}x</p>
        <p>${item.price}</p>
        <button class="remove-button" data-index="${index}">Remove</button>
      </div>
    `;
    container.appendChild(productDiv);
  });

  totalSection.innerHTML = `
    <h2>Total: ${total} kr.</h2>
    <a href="order_confirmed.html"><button class="checkout-button">Checkout</button></a>
  `;

  document.querySelectorAll(".remove-button").forEach(button => {
    button.addEventListener("click", () => {
      const index = button.dataset.index;
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    });
  });
}

document.addEventListener("DOMContentLoaded", renderCart);
